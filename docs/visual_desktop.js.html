<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: visual/desktop.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: visual/desktop.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Creates a window organizer
 * @class Desktop
 */
class Desktop {
    /**
     * Create a desktop
     * @property {Object&lt;string, Layered>} windows - windows
     * @property {HTMLElement} element - desktop element
     * @property {GeneratorFunction} trackingid - incrementing number generator
     * @returns {Desktop}
     */
    constructor() {
        const desktop = document.createElement("div");
        desktop.id = "desktop";
        document.body.appendChild(desktop);
        /** @type {HTMLElement} */
        this.element = document.getElementById("desktop");
        /** @type {Object&lt;string, Layered>} */
        this.windows = {};
        /** @type {listTrackerGenerator} */
        this.trackingid = listTrackerGenerator();
        /** @type {{x: number, y: number}} */
        this.nextpos = {x: 0, y: 50};
        return this;
    }

    /**
     * Create/Update event listeners
     * @param {string} name - name of the window
     */
    updateListeners(name) {
        const w = document.querySelector(`#${this.windows[name].htmlhook.parentElement.id}`);

        // Resize button
        w.querySelector(`.window-header-button-resize`).onmousedown = (e) => {
            e.preventDefault();
            const startX = e.clientX;
            const startY = e.clientY;
            const startWidth = Number(w.style.width.replace("px", ""));
            const startHeight = Number(w.style.height.replace("px", "")) - 30;

            document.onmouseup = (e) => {
                document.onmouseup = null;
                document.onmousemove = null;
            };

            document.onmousemove = (e) => {
                const width = startWidth + e.clientX - startX;
                const height = startHeight + e.clientY - startY;
                w.style.width = width + "px";
                w.style.height = (height + 30) + "px";
                this.windows[name].call(layer => layer.resize(width, height));
                window.dispatchEvent(new Event("resize"));
            }
        };

        // Drag button
        w.querySelector(`.window-header-button-drag`).onmousedown = (e) => {;
            e.preventDefault();
            const startX = e.clientX - w.offsetLeft;
            const startY = e.clientY - w.offsetTop;

            document.onmouseup = () => {
                document.onmouseup = null;
                document.onmousemove = null;
            };

            document.onmousemove = (e) => {
                e.preventDefault();
                w.style.left = (e.clientX - startX) + "px";
                w.style.top = (e.clientY - startY) + "px";
            };
        };

        // Close button
        w.querySelector(`.window-header-button-close`).onclick = () => this.removeWindow(name);
    }

    /**
     * Creates a window that can be dragged and resized
     * @param {string} name
     * @param {windowOptions} options
     * @returns {{string: Layered}}
     */
    createWindow(name, options) {
        if(this.windows[name]) throw new Error(`Window ${name} already exists`);
        const w = document.createElement("div");
        w.classList.add("window");
        w.id = `did-${this.trackingid.next().value.number}`;
        w.style.zIndex = options.zIndex;
        w.style.width = options.width + "px";
        w.style.height = (options.height + 30) + "px";
        
        if(this.nextpos.x + options.width > document.body.clientWidth) {
            this.nextpos.x = 0;
            this.nextpos.y += options.height + 30;
        }
        w.style.left = this.nextpos.x + "px";
        w.style.top = this.nextpos.y + "px";
        this.nextpos.x += options.width;

        if(options.position.x != null) {
            w.style.left = options.position.x + "px";
        }
        if(options.position.y != null) {
            w.style.top = (options.position.y + 50 + 30) + "px";
        }

        const wHeader = document.createElement("div");
        wHeader.classList.add("window-header");
        wHeader.innerHTML = `&lt;h3 class="window-header-title">${name}&lt;/h3>`;
        
        if(options.resizable) wHeader.innerHTML += `&lt;div class="window-header-button window-header-button-resize">⇱&lt;/div>`;
        if(options.dragable) wHeader.innerHTML += `&lt;div class="window-header-button window-header-button-drag">◌&lt;/div>`;
        if(options.closeable) wHeader.innerHTML += `&lt;div class="window-header-button window-header-button-close">✕&lt;/div>`;
        
        const wBody = document.createElement("div");
        wBody.classList.add("window-body");

        w.appendChild(wHeader);
        w.appendChild(wBody);
            
        this.windows[name] = new Layered(wBody, options);
        this.element.appendChild(w);

        this.updateListeners(name);
        this.options = options;

        return this;
    }

    /**
     * Remove a window
     */
    removeWindow(name) {
        this.element.removeChild(this.windows[name].htmlhook.parentElement);
        delete this.windows[name];
    }

    /**
     * Get a window by name
     * @param {string} name
     * @returns {Layered}
     */
    getWindow(name) {
        return this.windows[name];
    }

    /**
     * Get information about the desktop
     * @returns {Object}
     */
    getInfo() {
        return {
            windows: Object.keys(this.windows),
            width: this.element.clientWidth,
            height: this.element.clientHeight,
        };
    }

    /**
     * Run a function on a window
     * @param {callback&lt;Layered>} func
     * @param {...string} name
     */
    callOn(func, ...names) {
        if(typeof func !== "function") throw new Error(`${func} is not a function`);
        names.forEach(name => {
            if(this.windows[name]) func(this.windows[name]);
        });
    }

    /**
     * Run a function on all windows
     * @param {callbackVoid&lt;Layered>} func
     */
    call(func) {
        Object.keys(this.windows).forEach(key => {
            func(this.windows[key]);
        });
    }

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Canvas.html">Canvas</a></li><li><a href="Complex.html">Complex</a></li><li><a href="Coordinate.html">Coordinate</a></li><li><a href="Desktop.html">Desktop</a></li><li><a href="FourierSeries.html">FourierSeries</a></li><li><a href="Graph.html">Graph</a></li><li><a href="ImageStyle.html">ImageStyle</a></li><li><a href="Kinematic.html">Kinematic</a></li><li><a href="Layered.html">Layered</a></li><li><a href="LineStyle.html">LineStyle</a></li><li><a href="Matrix.html">Matrix</a></li><li><a href="Series.html">Series</a></li><li><a href="Style.html">Style</a></li><li><a href="TextStyle.html">TextStyle</a></li><li><a href="TimeDomain.html">TimeDomain</a></li><li><a href="Vector.html">Vector</a></li></ul><h3>Global</h3><ul><li><a href="global.html#defaultWindowOptions">defaultWindowOptions</a></li><li><a href="global.html#degToRad">degToRad</a></li><li><a href="global.html#FIT">FIT</a></li><li><a href="global.html#getCSSVariable">getCSSVariable</a></li><li><a href="global.html#increment">increment</a></li><li><a href="global.html#incrementGenerator">incrementGenerator</a></li><li><a href="global.html#invertColorString">invertColorString</a></li><li><a href="global.html#listTrackerGenerator">listTrackerGenerator</a></li><li><a href="global.html#loop">loop</a></li><li><a href="global.html#radToDeg">radToDeg</a></li><li><a href="global.html#sum">sum</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Tue Aug 30 2022 17:22:43 GMT+0200 (Centraleuropæisk sommertid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
